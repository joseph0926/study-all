---
name: forge
description: 산발적 학습을 통합 멘탈모델 + 실전 판단 프레임워크로 결정화 — 통합 비유 + 핵심 원칙 + Q&A. Codex에서는 `$forge <skill> [scope]`로 호출한다.
---

# forge

입력: `$forge <skill> [scope]` (예: `$forge react`, `$forge react rendering`)

실행 순서:

0. `mcp__study__context_resolve(mode=skill, skill=<skill>)`로 컨텍스트 확인
1. `$ARGUMENTS`에서 `<skill> [scope]` 파싱 (`skill` 필수, `scope` 선택)

---

## Phase 0: 인벤토리

1. `study/{skill}/` 하위 모든 `.md` 파일 목록 수집 (Glob)
2. `study/learn/` 에서 해당 skill 관련 파일 교차 수집 (Grep으로 키워드 매칭)
3. `mcp__study__progress_getPlan(context)`으로 plan.md 로드 → 완료/미완료 토픽 파악
4. 각 토픽의 meta 파일 읽기 (Read) → 약점 추출:
   - `wrong` 또는 `retry_pass` 점수의 개념 목록
   - streak 0인 개념
5. scope 지정 시: 관련 토픽만 필터링
6. 사용자에게 인벤토리 보고:

   ```
   ## 인벤토리
   - 대상 토픽: {N}개 (scope: {scope 또는 "전체"})
   - 커버리지: plan.md 기준 {완료}/{전체}
   - 약점 개념: {N}개 (wrong/retry_pass)
   - 토픽 목록: ...
   ```

7. 사용자 확인 후 Phase 1 진행.

---

## Phase 1: 통합 비유 + 핵심 원칙

### 1-A. 토픽 읽기

각 토픽 파일을 Read하고 핵심 개념을 추출한다:
- 토픽별 핵심 개념 (1~3문장)
- 소스 경로 참조 (`file:line`)
- 토픽 간 기존 연결 (파일 내 언급된 다른 토픽/개념)
- 약점 개념 표시

### 1-B. 통합 비유 (Mega-Analogy)

모든 핵심 개념을 **하나의 세계관**으로 연결하는 비유를 구성한다.

규칙:
- 비유의 각 요소와 실제 개념 간 **1:1 대응**을 명시한다.
- 대응 요소가 3개 미만이면 통합 비유를 생략하고 "비유 한계:" 설명만 남긴다.
- 1:1 대응이 불가능한 부분은 "비유 한계:" 접두사로 이유와 부분 비유를 제시한다.
- 비유를 위해 사실을 왜곡하지 않는다.

제시 형식:
```
## 통합 비유: {비유 제목}

{비유 세계관 설명}

| 비유 요소 | 실제 개념 | 대응 이유 |
|-----------|-----------|-----------|
| ...       | ...       | ...       |

{비유 한계가 있으면 여기에 명시}
```

### 1-C. 핵심 원칙 추출

3~5개 핵심 원칙을 추출한다. 각 원칙의 구조:

- **이름**: 2~5단어, 기억하기 쉬운 이름
- **한 줄 요약**: 1문장
- **근거**: 어떤 토픽에서 비롯되었는지 (토픽 참조 + `file:line` 가능 시 포함)
- **기억법**: 통합 비유의 해당 요소 연결 또는 독립 비유/이미지
- **약점 연결**: 해당 원칙과 관련된 약점 개념이 있으면 명시

원칙 선정 기준:
- 여러 토픽에 걸쳐 반복되는 패턴 우선
- 실전 판단에 직접 영향을 주는 것 우선
- 약점 개념이 포함된 영역 우선

### 1-D. Q&A (L1 연결)

통합 비유와 핵심 원칙을 제시한 후, **연결 이해**를 검증하는 Q&A를 출제한다.

- L1 (연결): "A와 B는 어떤 관계인가?", "비유에서 X에 해당하는 실제 개념은?"
- 1~2문제 출제
- 오답 시: 보충 설명 후 재질문
- 정답 시: 다음 Phase로

사용자 `>>다음` 신호로 Phase 2 진행.

---

## Phase 2: 판단 프레임워크 + Q&A

### 2-A. 실전 시나리오 구성

핵심 원칙 + 약점 개념을 기반으로 실전 시나리오 3~7개를 구성한다.

각 시나리오의 구조:
- **상황**: 실제 코딩/설계/디버깅 시 마주치는 상황
- **떠올려**: 어떤 원칙/개념을 떠올려야 하는지
- **근거**: 왜 그 원칙이 적용되는지
- **안티패턴**: "이렇게 하면 안 되는 이유" (선택, 관련 시)

시나리오 구성 기준:
- 약점 개념이 포함된 시나리오를 반드시 1개 이상 포함
- 원칙이 2개 이상 교차하는 시나리오 우선
- 추상적 상황보다 구체적 코드/설계 상황 선호

### 2-B. Q&A (L2 판단, L3 설계)

시나리오를 제시한 후, **판단/설계** 수준의 Q&A를 출제한다.

- L2 (판단): "상황 X에서 어떤 원칙을 적용해야 하나?"
- L3 (설계): "Y를 구현한다면 어떤 트레이드오프를 고려해야 하나?"
- 2~3문제 출제
- L2 정답 → L3 에스컬레이션. 오답 시 보충 설명 후 재질문.
- 추가 질문/논의 자유롭게 이어갈 수 있다.

사용자 `>>정리` 또는 `>>끝` 신호로 Phase 3 진행.

---

## Phase 3: 문서화

`>>정리` 또는 `>>끝` 시:

1. `study/{skill}/FORGE-{Name}.md`에 Write한다.

   Name 규칙: 핵심 주제를 반영한 kebab-case (예: `FORGE-업데이트-처리-파이프라인.md`)

2. `mcp__study__session_appendLog(context, topic="FORGE-{Name}", content=<요약>)`로 세션 기록.

문서 템플릿:

```markdown
# FORGE: {제목}

> 생성일: {YYYY-MM-DD}
> 기반 토픽: {토픽 목록}
> 범위: {scope 또는 "전체"}

---

## 통합 비유: {비유 제목}

{비유 세계관 설명}

| 비유 요소 | 실제 개념 | 대응 이유 |
|-----------|-----------|-----------|
| ...       | ...       | ...       |

{비유 한계가 있으면 여기에 명시}

---

## 핵심 원칙

### 1. {원칙 이름}
> {한 줄 요약}

**근거**: {토픽 참조}
**기억법**: {비유/이미지}

### 2. ...

---

## 판단 프레임워크

### 상황: {시나리오}
**떠올려**: ...
**근거**: ...
**안티패턴**: ...

### 상황: ...

---

## 약점 보강

> review에서 자주 틀린 개념들의 핵심 정리

### {개념}
**핵심**: ...
**왜 헷갈리나**: ...
**기억법**: ...

---

## Q&A 기록

### Q1 (L{N}). {질문}
**A**: {사용자 답변}
**Score**: {정답/오답}
**보충**: {오답 시 보충 설명}

---

## 원페이저

| 원칙 | 한 줄 | 상황 | 기억법 |
|------|-------|------|--------|
| ...  | ...   | ...  | ...    |
```

---

## 사용자 신호 규칙

- `>>다음` — Phase 1 → Phase 2 전환
- `>>정리` 또는 `>>끝` — 세션 종료 + Phase 3 실행
- 일반 대화 속 "다음", "정리", "끝"은 신호로 인식하지 않는다 (`>>` 접두사 필수).

## 규칙

- 기존 study/ 파일은 **읽기만** 한다. 수정하지 않는다.
- 쓰기 동작은 `>>정리` 이후에만 수행한다.
- Q&A 원문은 오타 수정만 하고 그대로 기록한다.
- 통합 비유가 불가능하면 강제하지 않는다 ("비유 한계:" 처리).
- 비유를 위해 사실을 왜곡하지 않는다.
- 모든 원칙/프레임워크에 토픽 참조를 포함한다.
- 기존 /learn 비유가 있으면 새로 만들지 않고 재활용/확장한다.
- AI가 자체 판단으로 Phase를 건너뛰지 않는다.
